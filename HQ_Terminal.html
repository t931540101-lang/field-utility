<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>HQ Terminal | ç¸½éƒ¨ç®¡ç†å¾Œå°</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { font-family: sans-serif; background: #f0f2f5; padding: 20px; }
        .container { max-width: 900px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #4a76a8; border-bottom: 2px solid #4a76a8; padding-bottom: 10px; }
        .section { margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        h2 { color: #333; font-size: 18px; margin-top: 0; }
        input { padding: 8px; margin-right: 5px; border: 1px solid #ccc; width: 150px; }
        button { padding: 8px 15px; background: #4a76a8; color: white; border: none; cursor: pointer; border-radius: 4px; }
        button:hover { background: #3a5d85; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 14px; }
        th, td { border: 1px solid #eee; padding: 10px; text-align: left; }
        th { background: #f8f9fa; }
        .btn-del { background: #ff4d4f; }
    </style>
</head>
<body>

<div class="container">
    <h1>M-SECURITY ç¸½éƒ¨æ§åˆ¶å° (HQ)</h1>

    <div class="section">
        <h2>ğŸ‘¥ å“¡å·¥è³‡æ–™éƒ¨ç½² (é€£å‹•æ‰‹æ©ŸæŸ¥è©¢)</h2>
        <input type="text" id="empID" placeholder="å·¥è™Ÿ">
        <input type="text" id="empName" placeholder="å§“å">
        <input type="text" id="empDept" placeholder="å–®ä½">
        <input type="text" id="empPlate" placeholder="è»Šç‰Œ">
        <button onclick="uploadEmployee()">ä¸Šå‚³è³‡æ–™</button>
        <table id="empTable">
            <thead><tr><th>å·¥è™Ÿ</th><th>å§“å</th><th>å–®ä½</th><th>è»Šç‰Œ</th><th>æ“ä½œ</th></tr></thead>
            <tbody id="empList"></tbody>
        </table>
    </div>

    <div class="section">
        <h2>ğŸ›‘ ç®¡åˆ¶é»‘åå–®ç™¼å¸ƒ (é€£å‹•é€²éšåˆ†é )</h2>
        <input type="text" id="blackTarget" placeholder="å°è±¡ (å§“åæˆ–è»Šç‰Œ)">
        <input type="text" id="blackReason" placeholder="ç®¡åˆ¶åŸå› ">
        <button onclick="uploadBlacklist()" style="background:#d32f2f;">ç™¼å¸ƒè­¦å ±</button>
        <table id="blackTable">
            <thead><tr><th>å°è±¡</th><th>åŸå› </th><th>æ™‚é–“</th><th>æ“ä½œ</th></tr></thead>
            <tbody id="blackList"></tbody>
        </table>
    </div>
</div>

<script>
    // Firebase é…ç½®
    const firebaseConfig = {
        apiKey: "AIzaSyB2_tKKsVT4kdW7PPkJgI9O7S1YdCWor48",
        databaseURL: "https://factor-security-d1965-default-rtdb.firebaseio.com",
        projectId: "factor-security-d1965",
        appId: "1:864846943143:web:4cfa18cd20d2f712225c82"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // --- å“¡å·¥ç®¡ç†é‚è¼¯ ---
    function uploadEmployee() {
        const id = document.getElementById('empID').value.trim();
        const name = document.getElementById('empName').value.trim();
        const dept = document.getElementById('empDept').value.trim();
        const plate = document.getElementById('empPlate').value.trim().toUpperCase();
        if(!id || !name) return alert("å·¥è™Ÿèˆ‡å§“åå¿…å¡«");

        const data = { id, name, dept, plate };
        // ç‚ºäº†è®“æ‰‹æ©ŸæŸ¥å·¥è™Ÿæˆ–è»Šç‰Œéƒ½èƒ½ä¸­ï¼Œæˆ‘å€‘å­˜å…©ä»½ç´¢å¼•
        db.ref('employee_list/' + id).set(data);
        if(plate) db.ref('employee_list/' + plate).set(data);
        alert("è³‡æ–™åŒæ­¥æˆåŠŸ");
    }

    db.ref('employee_list').on('value', snap => {
        const list = snap.val();
        const tbody = document.getElementById('empList');
        tbody.innerHTML = '';
        for(let key in list) {
            // éæ¿¾æ‰é‡è¤‡çš„è»Šç‰Œç´¢å¼•ï¼Œåªé¡¯ç¤ºå·¥è™Ÿä¸»è³‡æ–™
            if (key === list[key].id) {
                const item = list[key];
                tbody.innerHTML += `<tr><td>${item.id}</td><td>${item.name}</td><td>${item.dept}</td><td>${item.plate}</td><td><button class="btn-del" onclick="deleteEmp('${item.id}','${item.plate}')">åˆªé™¤</button></td></tr>`;
            }
        }
    });

    function deleteEmp(id, plate) {
        if(confirm("ç¢ºå®šåˆªé™¤ï¼Ÿ")) {
            db.ref('employee_list/' + id).remove();
            if(plate) db.ref('employee_list/' + plate).remove();
        }
    }

    // --- é»‘åå–®é‚è¼¯ ---
    function uploadBlacklist() {
        const name = document.getElementById('blackTarget').value.trim();
        const reason = document.getElementById('blackReason').value.trim();
        if(!name || !reason) return alert("å…§å®¹ä¸å¯ç‚ºç©º");

        db.ref('blacklist_data').push({
            name, reason, time: new Date().toLocaleDateString()
        });
        alert("è­¦å ±å·²ç™¼å¸ƒè‡³æ‰€æœ‰çµ‚ç«¯");
    }

    db.ref('blacklist_data').on('value', snap => {
        const list = snap.val();
        const tbody = document.getElementById('blackList');
        tbody.innerHTML = '';
        for(let key in list) {
            const item = list[key];
            tbody.innerHTML += `<tr><td>${item.name}</td><td>${item.reason}</td><td>${item.time}</td><td><button class="btn-del" onclick="db.ref('blacklist_data/${key}').remove()">æ’¤éŠ·</button></td></tr>`;
        }
    });
</script>
</body>
</html>
