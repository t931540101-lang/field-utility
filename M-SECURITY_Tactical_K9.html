<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>M-POLICE | K9 æ•´åˆçµ‚ç«¯</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <style>
        :root { --police-blue: #4a76a8; --neon-green: #39ff14; --bg-dark: #f0f2f5; }
        body { font-family: -apple-system, "Microsoft JhengHei", sans-serif; background: var(--bg-dark); margin: 0; }
        .nav-header { background: linear-gradient(to bottom, #7ba6d9, #4a76a8); color: white; padding: 12px 0; text-align: center; }
        .nav-tabs { display: flex; background: #6089b3; border-bottom: 2px solid #4a76a8; sticky; top: 0; z-index: 100; }
        .tab { flex: 1; text-align: center; padding: 12px 0; font-size: 14px; color: #d1d5db; cursor: pointer; }
        .tab.active { background: #4a76a8; color: white; font-weight: bold; border-bottom: 3px solid var(--neon-green); }
        .page { display: none; padding: 15px; }
        .page.active { display: block; }
        .card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 15px; }
        textarea, input { width: 100%; border: 2px solid #ddd; border-radius: 4px; padding: 12px; font-size: 18px; box-sizing: border-box; background: #fff; }
        .btn-main { background: linear-gradient(to bottom, #4da1ff, #2188ff); color: white; border: none; width: 100%; padding: 15px; border-radius: 8px; font-size: 20px; font-weight: bold; margin: 10px 0; box-shadow: 0 4px #1a6edb; }
        .btn-main:active { transform: translateY(2px); box-shadow: 0 2px #1a6edb; }
        #reader { width: 100%; border: 2px solid var(--neon-green); display: none; margin-bottom: 10px; }
        .log-item { border-left: 5px solid var(--police-blue); padding: 10px; background: #eef2f7; margin-bottom: 10px; font-size: 14px; }
    </style>
</head>
<body>

<div class="nav-header"><h2 style="margin:0"><i>M-Police</i> æ•´åˆæŸ¥è©¢</h2></div>

<div class="nav-tabs">
    <div class="tab active" onclick="showPage('page1', this)">ä¸€èˆ¬</div>
    <div class="tab" onclick="showPage('page2', this)">é€²éš</div>
    <div class="tab" onclick="showPage('page3', this)">æ‡‰ç”¨</div>
    <div class="tab">é »é“</div>
    <div class="tab">è¨­å®š</div>
</div>

<div id="page1" class="page active">
    <div class="card">
        <div style="font-size:12px; color:#888;">è»Šç‰Œ/å·¥è™Ÿæª¢ç´¢ (é›²ç«¯é€£ç·š)</div>
        <textarea id="queryInput" placeholder="è¼¸å…¥è³‡æ–™æˆ–æƒææ¢ç¢¼"></textarea>
        <button class="btn-main" onclick="startQuery()">æŸ¥ è©¢</button>
        <div id="reader"></div>
        <button class="btn-main" style="background:#6089b3;" onclick="startScan()">æ¢ ç¢¼ æƒ æ</button>
    </div>
    <div id="res"></div>
</div>

<div id="page2" class="page">
    <h3 style="color:#4a76a8;">âš ï¸ é«˜é¢¨éšªç®¡åˆ¶åå–®</h3>
    <div class="card" id="blacklist">
        <div class="log-item"><b>[é›¢è·äººå“¡]</b> ç‹XX - ç¦æ­¢é€²å…¥å» å€</div>
        <div class="log-item"><b>[ç•°å¸¸å» å•†]</b> XXç‰©æµ - æ›¾æœ‰é•è¦ç´€éŒ„</div>
        <p style="font-size:12px; color:gray;">è³‡æ–™æ¯ 24 å°æ™‚è‡ªå‹•æ›´æ–°ä¸€æ¬¡</p>
    </div>
</div>

<div id="page3" class="page">
    <h3 style="color:#4a76a8;">ğŸ› ï¸ è­¦è¡›å‹¤å‹™å·¥å…·</h3>
    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
        <div class="card" onclick="alert('ç·Šæ€¥é€šå ±å·²ç™¼é€')" style="text-align:center; background:#fee2e2;">ğŸš¨ ç·Šæ€¥æ”¯æ´</div>
        <div class="card" onclick="alert('é–€å“¨ç‹€æ…‹å·²åˆ‡æ›')" style="text-align:center; background:#dcfce7;">ğŸ”“ é ç«¯é–‹é–€</div>
        <div class="card" onclick="alert('æ—¥èªŒå‚™ä»½ä¸­')" style="text-align:center; background:#e0f2fe;">ğŸ“‹ å‹¤å‹™æ—¥èªŒ</div>
        <div class="card" onclick="location.reload()" style="text-align:center; background:#fef3c7;">ğŸ”„ åŒæ­¥æ•¸æ“š</div>
    </div>
</div>

<script>
    // é é¢åˆ‡æ›é‚è¼¯
    function showPage(id, el) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        el.classList.add('active');
        if(id !== 'page1') stopScan(); // åˆ‡æ›é é¢åœæ­¢æƒæ
    }

    // æ¢ç¢¼æƒæåº«æ•´åˆ
    let html5QrCode;
    function startScan() {
        document.getElementById('reader').style.display = 'block';
        html5QrCode = new Html5Qrcode("reader");
        html5QrCode.start(
            { facingMode: "environment" }, 
            { fps: 10, qrbox: { width: 250, height: 150 } },
            (decodedText) => {
                document.getElementById('queryInput').value = decodedText;
                stopScan();
                startQuery(); // æƒåˆ°è‡ªå‹•æŸ¥è©¢
            }
        ).catch(err => alert("ç›¸æ©Ÿå•Ÿå‹•å¤±æ•—"));
    }

    function stopScan() {
        if(html5QrCode) {
            html5QrCode.stop().then(() => {
                document.getElementById('reader').style.display = 'none';
            });
        }
    }

    // æ¨¡æ“¬ Firebase æŸ¥è©¢
    function startQuery() {
        const val = document.getElementById('queryInput').value.trim().toUpperCase();
        if(!val) return;
        const res = document.getElementById('res');
        res.innerHTML = `<div class="card" style="border-left:8px solid #39ff14;"><b>æª¢ç´¢çµæœï¼š${val}</b><p>èº«ä»½ï¼šæ­£å¼å“¡å·¥</p><p>å–®ä½ï¼šå®‰å…¨éƒ¨ (K9)</p></div>`;
    }
</script>
</body>
</html>
