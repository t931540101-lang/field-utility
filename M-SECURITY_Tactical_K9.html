<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>M-SECURITY | 雲端勤務系統</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        :root { --bg: #000000; --neon-green: #39ff14; --neon-blue: #00f2ff; --warn-red: #ff3131; }
        body { background: var(--bg); color: var(--neon-green); font-family: 'Courier New', monospace; margin: 0; padding: 10px; overflow-x: hidden; }
        
        /* 螢幕掃描線視覺特效 */
        .crt-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03)); z-index: 100; background-size: 100% 2px, 3px 100%; pointer-events: none; }

        .terminal { border: 2px solid var(--neon-green); padding: 15px; box-shadow: 0 0 15px var(--neon-green); position: relative; z-index: 1; }
        .header { text-align: center; border-bottom: 2px solid var(--neon-green); margin-bottom: 20px; padding-bottom: 10px; }
        .header h2 { margin: 0; letter-spacing: 6px; font-weight: 900; }
        
        .status-bar { display: flex; justify-content: space-between; font-size: 10px; color: var(--neon-blue); margin-bottom: 5px; }

        /* 查詢介面 */
        .query-box { background: #111; padding: 15px; border: 1px solid #333; margin-bottom: 20px; }
        .label { font-size: 12px; color: var(--neon-blue); margin-bottom: 8px; display: block; }
        input { background: #000; border: 1px solid var(--neon-green); color: var(--neon-green); padding: 15px; width: 100%; box-sizing: border-box; font-size: 22px; font-weight: bold; text-align: center; outline: none; box-shadow: inset 0 0 10px var(--neon-green); }

        /* 查詢結果區 */
        #result-display { display: none; margin-top: 20px; padding: 15px; border: 2px solid; animation: pulse 1.5s infinite; }
        .result-valid { border-color: var(--neon-green); color: var(--neon-green); }
        .result-invalid { border-color: var(--warn-red); color: var(--warn-red); }

        .info-item { border-bottom: 1px solid rgba(57, 255, 20, 0.2); padding: 12px 0; font-size: 18px; display: flex; justify-content: space-between; }
        .info-item span { color: var(--neon-blue); font-size: 12px; }

        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.8; } 100% { opacity: 1; } }
        
        /* 戰術按鈕 */
        .nav-btns { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
        .btn { border: 1px solid var(--neon-blue); background: transparent; color: var(--neon-blue); padding: 10px; font-size: 12px; font-weight: bold; cursor: pointer; text-align: center; }
    </style>
</head>
<body>
    <div class="crt-overlay"></div>
    <div class="terminal">
        <div class="status-bar">
            <span>UNIT: M-SECURITY</span>
            <span id="cloud-status">CLOUD: CONNECTING...</span>
        </div>
        
        <div class="header">
            <h2>M-POLICE</h2>
            <div style="font-size: 10px;">台灣精銳 - 戰術查驗終端</div>
        </div>

        <div class="query-box">
            <span class="label">SCAN INPUT: 車牌號碼 或 員工編號</span>
            <input type="text" id="userInput" placeholder="WAITING..." oninput="searchData()">
        </div>

        <div id="result-display">
            </div>

        <div class="nav-btns">
            <div class="btn" onclick="location.reload()">重新整理系統</div>
            <div class="btn" style="border-color: var(--neon-green); color: var(--neon-green);">資料庫同步中</div>
        </div>
    </div>

    <script>
        // Firebase 雲端配置
        const firebaseConfig = {
            apiKey: "AIzaSyB2_tKKsVT4kdW7PPkJgI9O7S1YdCWor48",
            databaseURL: "https://factor-security-d1965-default-rtdb.firebaseio.com",
            projectId: "factor-security-d1965",
            appId: "1:864846943143:web:4cfa18cd20d2f712225c82"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let employeeDB = {};

        // 從雲端抓取員工名單
        // 建議你在 Firebase 建立一個 'employee_list' 路徑
        db.ref('employee_list').on('value', (snapshot) => {
            const data = snapshot.val();
            if (data) {
                employeeDB = data;
                document.getElementById('cloud-status').innerText = "CLOUD: ONLINE";
                document.getElementById('cloud-status').style.color = "var(--neon-green)";
            }
        });

        function searchData() {
            const query = document.getElementById('userInput').value.toUpperCase().trim();
            const display = document.getElementById('result-display');
            
            if (query.length < 3) {
                display.style.display = 'none';
                return;
            }

            // 搜尋邏輯：同時對比 Key (車牌/工號)
            const person = employeeDB[query];
            display.style.display = 'block';

            if (person) {
                display.className = 'result-valid';
                display.innerHTML = `
                    <div style="font-weight:900; border-bottom: 2px solid; margin-bottom:10px;">>>> 身份確認：內部員工</div>
                    <div class="info-item"><span>NAME</span>${person.name}</div>
                    <div class="info-item"><span>DEPT</span>${person.dept}</div>
                    <div class="info-item"><span>ID_NO</span>${person.id}</div>
                    <div class="info-item"><span>PLATE</span>${person.plate || query}</div>
                `;
            } else {
                display.className = 'result-invalid';
                display.innerHTML = `
                    <div style="font-weight:900;">>>> 警告：未授權對象</div>
                    <p style="font-size:14px; margin-top:10px;">該編號/車牌不在雲端資料庫中。<br>請執行二次查驗或登記訪客。</p>
                `;
            }
        }
    </script>
</body>
</html>
