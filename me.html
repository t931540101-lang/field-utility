<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>柔的精算大腦 - 全年版</title>
    <style>
        body { font-family: sans-serif; background-color: #f5f5dc; margin: 0; padding: 0; color: #333; }
        .header { background-color: #000; color: #fff; padding: 15px; text-align: center; position: sticky; top: 0; z-index: 100; }
        .month-nav { margin: 10px 0; }
        select { padding: 5px; font-size: 16px; border-radius: 5px; }
        .stats { background: #333; padding: 10px; margin-top: 5px; border-radius: 5px; font-size: 14px; }
        .calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; padding: 10px; }
        .day { background: #fff; border: 1px solid #ddd; aspect-ratio: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 14px; border-radius: 4px; }
        .day.today { border: 2px solid #ff0000; }
        .btn-group { display: flex; justify-content: space-around; padding: 10px; background: #eee; }
        button { padding: 10px; border: none; border-radius: 5px; color: white; font-weight: bold; }
        .btn-work { background-color: #2e7d32; } /* 綠色：日B班 */
        .btn-off { background-color: #c62828; }  /* 紅色：休假 */
    </style>
</head>
<body>

<div class="header">
    <strong>K9 特休戰情室</strong>
    <div class="month-nav">
        <select id="monthSelect" onchange="renderCalendar()">
            </select>
    </div>
    <div class="stats">
        剩餘特休：<span id="hoursDisplay">100</span> hr
    </div>
</div>

<div id="calendar" class="calendar"></div>

<div class="btn-group">
    <button class="btn-work" onclick="adjustHours(-1)">-1 hr</button>
    <button class="btn-work" onclick="adjustHours(-4)">-4 hr</button>
    <button class="btn-work" onclick="adjustHours(-8)">-8 hr</button>
    <button style="background:#555" onclick="resetHours()">重置</button>
</div>

<script>
    let currentHours = parseFloat(localStorage.getItem('k9_hours')) || 100;
    const monthSelect = document.getElementById('monthSelect');

    // 初始化月份選單
    for (let i = 1; i <= 12; i++) {
        let opt = document.createElement('option');
        opt.value = i;
        opt.innerHTML = i + ' 月';
        if (i === new Date().getMonth() + 1) opt.selected = true;
        monthSelect.appendChild(opt);
    }

    function renderCalendar() {
        const year = 2026; // 固定 2026 年
        const month = monthSelect.value;
        const firstDay = new Date(year, month - 1, 1).getDay();
        const daysInMonth = new Date(year, month, 0).getDate();
        const container = document.getElementById('calendar');
        container.innerHTML = '';

        // 填充空白格子
        for (let i = 0; i < firstDay; i++) {
            container.innerHTML += '<div></div>';
        }

        // 生成日期
        for (let d = 1; d <= daysInMonth; d++) {
            const isToday = (d === new Date().getDate() && month == new Date().getMonth() + 1);
            container.innerHTML += `<div class="day ${isToday ? 'today' : ''}">${d}</div>`;
        }
        updateDisplay();
    }

    function adjustHours(val) {
        currentHours += val;
        saveData();
    }

    function resetHours() {
        if(confirm('確定要重置時數嗎？')) {
            currentHours = 100;
            saveData();
        }
    }

    function saveData() {
        localStorage.setItem('k9_hours', currentHours);
        updateDisplay();
    }

    function updateDisplay() {
        document.getElementById('hoursDisplay').innerText = currentHours;
    }

    renderCalendar();
</script>

</body>
</html>
