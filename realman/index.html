<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>K9 ç¸é†«è­·ç†ç«™ | é›²ç«¯åŒæ­¥ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f1f5f9; color: #1e293b; padding: 20px; }
        .medical-paper { background: white; border: 2px solid #334155; box-shadow: 6px 6px 0px #cbd5e1; border-radius: 4px; padding: 15px; margin-bottom: 20px; position: relative; }
        .stamp { border: 2px solid #ef4444; color: #ef4444; transform: rotate(-12deg); font-weight: 900; padding: 1px 6px; border-radius: 4px; display: inline-block; font-size: 10px; position: absolute; right: 15px; top: 10px; }
        .grid-table { display: grid; grid-template-columns: 60px 1fr 60px 1fr; border: 1.5px solid #1e293b; font-size: 12px; }
        .grid-label { background: #1e293b; color: white; padding: 4px; text-align: center; font-weight: bold; border: 0.5px solid #334155; }
        .grid-content { padding: 4px; border: 0.5px solid #1e293b; font-weight: bold; background: white; }
        .log-table { border: 1.5px solid #1e293b; border-top: none; margin-top: -1.5px; }
        .log-header { background: #f8fafc; border-bottom: 1.5px solid #1e293b; display: flex; font-weight: bold; font-size: 11px; }
        .log-row { display: flex; border-bottom: 1px solid #cbd5e1; font-size: 12px; min-height: 40px; }
    </style>
</head>
<body>

    <header class="flex justify-between items-end border-b-4 border-slate-800 pb-2 mb-6">
        <div>
            <h1 class="text-xl font-black text-slate-800 leading-tight">å°ç£ç²¾éŠ³çŠ¬éš»<br>è‡¨åºŠç—…æ­·ç³»çµ±</h1>
            <p class="text-[10px] font-bold text-slate-500 mt-1">ğŸ‘©â€âš•ï¸ è­·ç†å¸«ï¼šå°é»‘å“¥</p>
        </div>
        <div class="stamp">å·²èªè­‰</div>
    </header>

    <div class="medical-paper">
        <div class="grid-table">
            <div class="grid-label">å§“å</div><div class="grid-content text-blue-600">å¼µå¸ƒä¸</div>
            <div class="grid-label">é«”é‡</div><div class="grid-content">43.5 KG</div>
            <div class="grid-label">æ€§åˆ¥</div><div class="grid-content">M / 3Y+</div>
            <div class="grid-label">å“ç¨®</div><div class="grid-content">é«˜å±±çŠ¬</div>
        </div>
        
        <div class="log-table">
            <div class="log-header">
                <div class="w-[30%] p-1 text-center border-r-[1.5px] border-slate-800">è¨ºç™‚æ™‚é–“</div>
                <div class="w-[70%] p-1">è‡¨åºŠç´€éŒ„ (åŒæ­¥é›²ç«¯)</div>
            </div>
            <div id="puddingLogs">
                </div>
        </div>

        <button onclick="addLog('å¼µå¸ƒä¸', '43.5')" class="mt-4 w-full bg-slate-800 text-white py-3 font-black text-xs rounded active:bg-emerald-600 transition-colors">
            + æ–°å¢è‡¨åºŠç´€éŒ„ (SAVE TO CLOUD)
        </button>
    </div>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxm4CDB5i8V2CX6lbCu4gxI2TH-jGKFznI8H01CLlnKEh9Fdr71pfeQr7ai6VcVtAvomw/exec";
        
        // è¼‰å…¥æœ¬åœ°ç´€éŒ„
        let logs = JSON.parse(localStorage.getItem('K9_LOGS_SIMPLE') || '[]');
        renderLogs();

        async function addLog(name, weight) {
            const note = prompt(`ç‚º ${name} è¼¸å…¥è‡¨åºŠè¨ºç™‚å…§å®¹ï¼š`);
            if (!note) return;

            const now = new Date();
            const timeStr = `${now.getMonth()+1}/${now.getDate()} ${now.getHours()}:${(now.getMinutes()<10?'0':'')+now.getMinutes()}`;

            // 1. æœ¬åœ°é¡¯ç¤º
            logs.unshift({ time: timeStr, note: note });
            localStorage.setItem('K9_LOGS_SIMPLE', JSON.stringify(logs));
            renderLogs();

            // 2. èƒŒæ™¯åŒæ­¥é›²ç«¯
            try {
                const query = `type=k9&dogName=${encodeURIComponent(name)}&area=${encodeURIComponent(weight + " KG")}&health=é†«ç™‚ç´€éŒ„&note=${encodeURIComponent(note)}`;
                fetch(`${SCRIPT_URL}?${query}`, { mode: 'no-cors' });
                alert("âœ… ç´€éŒ„å·²åŒæ­¥è‡³æŒ‡æ®éƒ¨é›²ç«¯ï¼");
            } catch (e) {
                console.log("Sync Error");
            }
        }

        function renderLogs() {
            const container = document.getElementById('puddingLogs');
            if (logs.length === 0) {
                container.innerHTML = '<div class="p-4 text-center text-slate-300 italic text-xs">å°šç„¡ç´€éŒ„</div>';
                return;
            }
            container.innerHTML = logs.map(l => `
                <div class="log-row">
                    <div class="w-[30%] p-2 border-r-[1.5px] border-slate-800 text-[10px] text-slate-500 flex items-center justify-center font-mono text-center">${l.time}</div>
                    <div class="w-[70%] p-2 italic flex items-center font-medium">${l.note}</div>
                </div>
            `).join('');
        }
    </script>
</body>
</html>
