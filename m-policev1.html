<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å°ç¥æ• V8.1 | ç˜¦èº«ç‰ˆ</title>
    <link rel="icon" href="2020123001.png">
    <link rel="apple-touch-icon" href="2020123001.png">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { margin: 0; background: #e6eef5; font-family: sans-serif; text-align: center; }
        .header { background: linear-gradient(#dbe9f4, #8eb9d7); padding: 20px 0; border-bottom: 3px solid #005a9c; }
        .badge { width: 60px; height: 60px; }
        
        /* --- 1. [é€šå ±] ç˜¦èº«æ¨£å¼ --- */
        .alert-bar {
            background: rgba(0,0,0,0.8);
            color: #ff3333;
            padding: 4px 8px;
            text-align: center;
            font-size: 11px;
            font-weight: bold;
            border-bottom: 1px solid #ff3333;
        }

        .box { width: 90%; background: white; padding: 15px; margin: 15px auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.2); box-sizing: border-box; }
        input[type="text"], input[type="password"] { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #99b3cc; border-radius: 4px; font-size: 18px; box-sizing: border-box; }
        button { width: 100%; padding: 15px; background: #005a9c; color: white; border: none; border-radius: 5px; font-size: 20px; font-weight: bold; margin-top: 10px; }

        /* --- 2. çµæœé¡¯ç¤ºæ¡†ç˜¦èº« --- */
        .res-box { margin-top: 15px; padding: 10px; border-radius: 4px; display: none; text-align: center; border: 2px solid #ccc; }
        .res-ok { border-color: #4caf50; background: #e8f5e9; }
        .res-warn { border-color: #f44336; background: #ffebee; }

        /* --- 3. [é‡é»] ç¸®å° âœ…âš ï¸ ç¬¦è™Ÿ --- */
        .status-icon {
            font-size: 18px;
            margin-right: 5px;
            vertical-align: middle;
        }
    </style>
</head>
<body>

<div id="login-page">
    <div class="header">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/30/National_Police_Agency_Logo_of_the_Republic_of_China.svg/200px-National_Police_Agency_Logo_of_the_Republic_of_China.svg.png" class="badge">
        <div style="color:#003366; font-size:24px; font-weight:bold;">å…§æ”¿éƒ¨è­¦æ”¿ç½²</div>
    </div>
    <div class="box">
        <input type="text" id="pUser" placeholder="å¸³è™Ÿ (0905)">
        <input type="password" id="pPass" placeholder="å¯†ç¢¼ (0905)">
        <div style="margin:15px 0; font-size:18px;">
            <input type="radio" name="shift" value="æ—¥ç­" checked> â˜€ï¸æ—¥ç­
            <span style="margin:0 10px;"></span>
            <input type="radio" name="shift" value="å¤œç­"> ğŸŒ™å¤œç­
        </div>
        <button onclick="doLogin()">ç™» å…¥ ç³» çµ±</button>
    </div>
</div>

<div id="main-page" style="display:none;">
    <div style="background:#005a9c; color:white; padding:12px; font-weight:bold; display:flex; justify-content:space-between;">
        <span onclick="location.reload()">â¬… è¿”å›</span>
        <span id="shift-title">M-Police æŒ‡æ®ç«¯</span>
        <span onclick="location.reload()">ç™»å‡º</span>
    </div>
    
    <div class="alert-bar">[é€šå ±] æœ¬ç³»çµ±åƒ…ä¾›å…¬å‹™æŸ¥è©¢ä½¿ç”¨ï¼Œåš´ç¦éå…¬å‹™è¡Œç‚ºã€‚</div>
    
    <div class="box">
        <input type="text" id="qInput" placeholder="è¼¸å…¥å·¥è™Ÿæˆ–è»Šç‰Œ" oninput="this.value=this.value.toUpperCase()">
        <button onclick="qSearch()">é–‹ å§‹ æŸ¥ è©¢</button>
    </div>
    
    <div id="res-box" class="res-box">
        <div id="res-info"></div>
    </div>
</div>

<script>
    const firebaseConfig = { databaseURL: "https://m-security-v7-default-rtdb.firebaseio.com/" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function doLogin() {
        const u = document.getElementById('pUser').value;
        const p = document.getElementById('pPass').value;
        const s = document.querySelector('input[name="shift"]:checked').value;
        if(u === "0905" && p === "0905") {
            document.getElementById('login-page').style.display = 'none';
            document.getElementById('main-page').style.display = 'block';
            document.getElementById('shift-title').innerText = "M-Police [" + s + "]";
        } else { alert("å¸³å¯†éŒ¯èª¤"); }
    }

    async function qSearch() {
        const val = document.getElementById('qInput').value.trim();
        const resBox = document.getElementById('res-box');
        const resInfo = document.getElementById('res-info');
        if(!val) return;

        resBox.style.display = 'none';
        const [s1, s2] = await Promise.all([
            db.ref('black_list/' + val).once('value'),
            db.ref('employee_list/' + val).once('value')
        ]);

        resBox.style.display = 'block';

        // ç¬¬ä¸‰å€‹é€£å‹•ä¿®æ”¹ï¼šJS é¡¯ç¤ºé‚è¼¯
        if(s1.exists()){
            resBox.className = "res-box res-warn";
            resInfo.innerHTML = `
                <div style="font-size:16px; color:#b71c1c; margin-bottom:5px;">
                    <span class="status-icon">âš ï¸</span> è­¦æˆ’å°è±¡
                </div>
                <div style="font-size:32px; color:red; font-weight:bold;">${val}</div>
            `;
        } else if(s2.exists()){
            const d = s2.val();
            resBox.className = "res-box res-ok";
            resInfo.innerHTML = `
                <div style="font-size:16px; color:#1b5e20; margin-bottom:5px;">
                    <span class="status-icon">âœ…</span> å…§éƒ¨å“¡å·¥
                </div>
                <div style="font-size:24px; color:#000; font-weight:bold;">å§“åï¼š${d.name}</div>
                <div style="font-size:18px; color:#444; margin-top:5px;">å–®ä½ï¼š${d.reason || d.dept || 'æœªè¨»è¨˜'}</div>
            `;
        } else {
            resBox.className = "res-box";
            resBox.style.background = "#eee";
            resInfo.innerHTML = "ğŸ” æŸ¥ç„¡è³‡æ–™";
        }
    }
</script>
</body>
</html>
