<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>M-POLICE | å°ç£ç²¾éŠ³å‹¤å‹™çµ‚ç«¯</title>
    <style>
        /* æ ¸å¿ƒé…è‰²ï¼šè­¦ç”¨æ·±è—ã€è¢å…‰è—ã€è­¦æˆ’ç´… */
        :root {
            --police-black: #050505;
            --police-blue: #00e5ff;
            --police-green: #00ff41;
            --police-red: #ff003c;
            --card-bg: #121212;
        }

        body {
            background-color: var(--police-black);
            color: var(--police-blue);
            font-family: "Courier New", "Microsoft JhengHei", monospace;
            margin: 0;
            padding: 10px;
            overflow-x: hidden;
        }

        /* æˆ°è¡“æŠ¬é ­ */
        .terminal-header {
            border: 2px solid var(--police-blue);
            padding: 10px;
            margin-bottom: 15px;
            text-align: center;
            box-shadow: 0 0 15px rgba(0, 229, 255, 0.3);
            position: relative;
        }

        .terminal-header h1 {
            margin: 0;
            font-size: 22px;
            letter-spacing: 4px;
            text-shadow: 0 0 5px var(--police-blue);
        }

        /* è¼¸å…¥å€åŸŸ */
        .tactical-input-box {
            background: var(--card-bg);
            border: 1px solid #333;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }

        input, select {
            background: #000;
            border: 1px solid #444;
            color: var(--police-blue);
            padding: 12px;
            width: 100%;
            margin-bottom: 10px;
            font-size: 16px;
            box-sizing: border-box;
            outline: none;
        }

        input:focus {
            border-color: var(--police-blue);
        }

        .btn-execute {
            background: var(--police-blue);
            color: #000;
            border: none;
            padding: 15px;
            width: 100%;
            font-weight: 900;
            font-size: 18px;
            cursor: pointer;
            text-transform: uppercase;
        }

        /* æœå°‹æª¢ç´¢ */
        .search-bar {
            border: 1px solid var(--police-green);
            background: transparent;
            color: var(--police-green);
            padding: 10px;
            width: 100%;
            box-sizing: border-box;
            margin-bottom: 15px;
            font-weight: bold;
        }

        /* åˆ—è¡¨é¡¯ç¤º */
        .log-item {
            background: var(--card-bg);
            border: 1px solid #222;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 6px solid var(--police-blue);
            animation: blink 0.5s ease-out;
        }

        @keyframes blink {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .log-item.done {
            border-left-color: var(--police-green);
            opacity: 0.6;
        }

        .log-item b { font-size: 20px; display: block; margin-bottom: 5px; }
        .log-item span { font-size: 12px; color: #888; }

        .btn-status {
            margin-top: 10px;
            padding: 8px 15px;
            background: transparent;
            border: 1px solid var(--police-blue);
            color: var(--police-blue);
            font-weight: bold;
            cursor: pointer;
        }

        .btn-status.done {
            border-color: var(--police-green);
            color: var(--police-green);
        }
    </style>
</head>
<body>

    <div style="font-size: 10px; margin-bottom: 5px;">
        UNIT: FACTOR-K9 | STATUS: DISCONNECTED
    </div>

    <div class="terminal-header">
        <h1>M-POLICE åŒ…è£¹æª¢ç´¢çµ‚ç«¯</h1>
    </div>

    <div class="tactical-input-box">
        <input type="text" id="dept" placeholder="[ å–®ä½ä»£è™Ÿ ]">
        <input type="text" id="name" placeholder="[ å—è´ˆäºº/æ”¶ä»¶äººå§“å ]">
        <select id="type">
            <option value="ğŸ“¦ ä¸€èˆ¬ä»¶">ğŸ“¦ ä¸€èˆ¬ä»¶ (GENERAL)</option>
            <option value="âœ‰ï¸ æ›è™Ÿä»¶">âœ‰ï¸ æ›è™Ÿä»¶ (REGISTERED)</option>
            <option value="â„ï¸ ä½æº«ä»¶">â„ï¸ ä½æº«ä»¶ (COLD CHAIN)</option>
        </select>
        <button class="btn-execute" onclick="addEntry()">åŸ·è¡Œç™»è¨˜ (EXECUTE)</button>
    </div>

    <input type="text" class="search-bar" id="search" onkeyup="filter()" placeholder="ğŸ” å¿«é€Ÿæƒæè³‡æ–™åº«...">

    <div id="display"></div>

    <script>
        // æœ¬åœ°å­˜å„²é‚è¼¯
        let dataStore = JSON.parse(localStorage.getItem('m_police_v1')) || [];

        function sync() {
            localStorage.setItem('m_police_v1', JSON.stringify(dataStore));
            render();
        }

        function addEntry() {
            const n = document.getElementById('name').value;
            if(!n) return alert("ç³»çµ±éŒ¯èª¤ï¼šå§“åæœªè¼¸å…¥");
            
            const entry = {
                id: Date.now(),
                d: document.getElementById('dept').value || "SYS-NONE",
                n: n,
                t: document.getElementById('type').value,
                time: new Date().toLocaleString(),
                st: 'pending',
                sign: ''
            };
            dataStore.unshift(entry);
            sync();
            document.getElementById('name').value = '';
        }

        function toggle(id) {
            const item = dataStore.find(x => x.id === id);
            if(item.st === 'pending') {
                const s = prompt("ç°½æ”¶è€…ç¢ºèªï¼š");
                if(s) { item.st = 'done'; item.sign = `${new Date().toLocaleTimeString()} [${s}]`; }
            } else {
                if(confirm("é‡è¨­å‹¤å‹™ç‹€æ…‹ï¼Ÿ")) { item.st = 'pending'; item.sign = ''; }
            }
            sync();
        }

        function del(id) {
            if(confirm("æ°¸ä¹…åˆªé™¤æ­¤ç­†ç´€éŒ„ï¼Ÿ")) {
                dataStore = dataStore.filter(x => x.id !== id);
                sync();
            }
        }

        function render(list = dataStore) {
            const container = document.getElementById('display');
            container.innerHTML = '';
            list.forEach(i => {
                const div = document.createElement('div');
                div.className = `log-item ${i.st === 'done' ? 'done' : ''}`;
                div.innerHTML = `
                    <b>ID: ${i.n}</b>
                    <span>å–®ä½: ${i.d} | é¡åˆ¥: ${i.t}</span><br>
                    <span>ç´€éŒ„æ™‚é–“: ${i.time}</span>
                    ${i.sign ? `<p style="color:var(--police-green); margin:5px 0;">>>> å·²çµæ¡ˆ: ${i.sign}</p>` : ''}
                    <div style="margin-top:10px;">
                        <button class="btn-status ${i.st === 'done' ? 'done' : ''}" onclick="toggle(${i.id})">
                            ${i.st === 'pending' ? 'åŸ·è¡Œç°½æ”¶' : 'ä»»å‹™å®Œæˆ'}
                        </button>
                        <button style="float:right; background:none; border:none; color:#444; font-size:10px;" onclick="del(${i.id})">åˆªé™¤</button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function filter() {
            const query = document.getElementById('search').value.toLowerCase();
            render(dataStore.filter(i => i.n.toLowerCase().includes(query) || i.d.toLowerCase().includes(query)));
        }

        window.onload = render;
    </script>
</body>
</html>
