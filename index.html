<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SECURE GUARD | 行動指揮中心</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f8fafc; color: #1e293b; -webkit-tap-highlight-color: transparent; margin: 0; overflow-x: hidden; }
        .sidebar-bg { background-color: #1a2233; }
        .active-item { background-color: #2563eb; color: white; }
        .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
        input { border: 1px solid #e2e8f0; border-radius: 0.5rem; padding: 0.5rem; width: 100%; font-size: 0.9rem; background: white; }
        .sidebar-transition { transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .glass-header { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border-bottom: 1px solid #e2e8f0; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        // 圖標組件
        const Icon = ({ name, size = 20, className = "" }) => {
            const p = {
                menu: "M3 12h18M3 6h18M3 18h18",
                close: "M18 6L6 18M6 6l12 12",
                shield: "M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",
                paw: "M12 13c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z M8 10c-1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z M16 10c-1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z",
                plus: "M12 5v14M5 12h14",
                pencil: "M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z",
                trash: "M3 6h18 M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",
                check: "M20 6L9 17l-5-5",
                dashboard: "M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z M9 22V12h6v10",
                truck: "M1 3h15v13H1z M16 8h4l3 3v5h-7z M5 18a1 1 0 1 0 0-2 1 1 0 0 0 0 2z M18 18a1 1 0 1 0 0-2 1 1 0 0 0 0 2z",
                users: "M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2 M9 7a4 4 0 1 0 0-8 4 4 0 0 0 0 8z",
                patrol: "M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z M12 13a3 3 0 1 0 0-6 3 3 0 0 0 0 6z",
                flame: "M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"
            };
            return <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className={className}><path d={p[name] || ""}/></svg>;
        };

        // K9 卡片
        const K9Card = ({ dog, onUpdate, onDelete }) => {
            const [edit, setEdit] = useState(false);
            const [val, setVal] = useState(dog.name);
            return (
                <div className="bg-white p-5 rounded-2xl shadow-sm border border-slate-100 relative">
                    <div className="absolute top-4 right-4 flex gap-2">
                        <button onClick={()=>setEdit(!edit)} className="text-slate-400 p-1"><Icon name={edit?"close":"pencil"} size={16}/></button>
                        <button onClick={()=>onDelete(dog.id)} className="text-slate-300 hover:text-red-500 p-1"><Icon name="trash" size={16}/></button>
                    </div>
                    <div className="flex items-center gap-4 mb-4">
                        <div className="w-12 h-12 bg-orange-50 rounded-xl flex items-center justify-center text-orange-500"><Icon name="paw" size={24}/></div>
                        <div>
                            {edit ? 
                                <div className="flex gap-2"><input value={val} onChange={e=>setVal(e.target.value)} className="w-24 p-1"/><button onClick={()=>{onUpdate(dog.id, {name:val}); setEdit(false)}} className="text-blue-500"><Icon name="check" size={18}/></button></div> 
                                : <h3 className="text-lg font-black text-slate-800">{dog.name}</h3>
                            }
                            <p className="text-[10px] text-slate-400 font-bold uppercase">K9 MEMBER</p>
                        </div>
                    </div>
                    <div className="flex gap-2">
                        {['healthy','observation','sick'].map(s=>(<button key={s} onClick={()=>onUpdate(dog.id, {status:s})} className={`flex-1 py-2 rounded-xl text-[10px] font-black border ${dog.status===s?'bg-blue-600 text-white border-blue-600':'text-slate-400 border-slate-100'}`}>{s==='healthy'?'健康':s==='observation'?'觀察':'就醫'}</button>))}
                    </div>
                </div>
            )
        };

        function App() {
            const [sb, setSb] = useState(false);
            const [tab, setTab] = useState('dashboard');
            const [time, setTime] = useState(new Date());
            const [add, setAdd] = useState(false);
            const [editLog, setEditLog] = useState(null);
            const [editTxt, setEditTxt] = useState("");
            
            const [dogs, setDogs] = useState([{id:1, name:'柔', status:'healthy'}, {id:2, name:'歐告', status:'observation'}]);
            const [logs, setLogs] = useState([{id:1, time:'14:00', info:'訪客 - 王先生'}]);

            useEffect(() => { const t = setInterval(() => setTime(new Date()), 1000); return () => clearInterval(t); }, []);

            const menu = [
                {id:'dashboard', icon:'dashboard', label:'監控儀表板'},
                {id:'vehicles', icon:'truck', label:'物流車輛'},
                {id:'visitors', icon:'users', label:'訪客管理'},
                {id:'patrol', icon:'patrol', label:'巡邏打卡'},
                {id:'k9', icon:'paw', label:'K9 專區'}
            ];

            return (
                <div className="min-h-screen flex flex-col bg-slate-50 safe-bottom">
                    <header className="glass-header p-4 flex justify-between items-center sticky top-0 z-40">
                        <button onClick={()=>setSb(true)} className="p-2 text-slate-600"><Icon name="menu" size={24}/></button>
                        <div className="flex items-center gap-2"><div className="bg-blue-600 p-1.5 rounded-lg text-white"><Icon name="shield" size={18}/></div><span className="font-black text-slate-800 tracking-tight">SECURE GUARD</span></div>
                        <div className="w-8"/>
                    </header>

                    {/* Sidebar */}
                    <div className={`fixed inset-0 z-50 transition-all ${sb ? 'visible' : 'invisible'}`}>
                        <div className={`absolute inset-0 bg-black/60 transition-opacity ${sb ? 'opacity-100' : 'opacity-0'}`} onClick={()=>setSb(false)}/>
                        <aside className={`absolute left-0 top-0 bottom-0 w-[280px] sidebar-bg sidebar-transition transform ${sb ? 'translate-x-0' : '-translate-x-full'} flex flex-col`}>
                            <div className="p-6 flex justify-between text-white">
                                <div className="flex gap-2 items-center"><Icon name="shield" className="text-blue-500"/><span className="font-black italic text-lg">SECUREGUARD</span></div>
                                <button onClick={()=>setSb(false)} className="text-slate-500"><Icon name="close"/></button>
                            </div>
                            <div className="px-5 mb-6"><div className="bg-slate-800 p-5 rounded-xl border border-white/5"><p className="text-[10px] text-slate-400 mb-1">系統時間</p><p className="text-3xl font-black text-white font-mono mb-2">{time.toLocaleTimeString([],{hour12:false})}</p><p className="text-[10px] text-slate-400 font-bold">{time.toLocaleDateString()}</p></div></div>
                            <div className="px-5 mb-6"><div className="bg-green-500/10 border border-green-500/20 p-3 rounded-xl flex gap-3 text-green-500"><Icon name="flame"/><span className="text-sm font-bold">消防正常</span></div></div>
                            <nav className="flex-1 px-3 space-y-1">
                                {menu.map(m=><button key={m.id} onClick={()=>{setTab(m.id); setSb(false)}} className={`w-full flex gap-4 p-4 rounded-xl font-bold text-sm ${tab===m.id?'active-item':'text-slate-400 hover:bg-white/5'}`}><Icon name={m.icon}/>{m.label}</button>)}
                            </nav>
                            <div className="p-6 border-t border-white/5 flex gap-4 items-center"><div className="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-black">黑</div><div><p className="text-white font-bold text-sm">值班：小黑哥</p><p className="text-[10px] text-green-500 font-bold">● 執勤中</p></div></div>
                        </aside>
                    </div>

                    <main className="flex-1 p-5 space-y-6">
                        {tab === 'dashboard' && (
                            <div className="space-y-6 animate-in fade-in">
                                <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-100"><h2 className="text-xl font-black text-slate-800">歡迎回來，小黑哥</h2><p className="text-xs text-slate-500 font-medium mt-1">System Guard 2/1 任務執行中。</p></div>
                                <div className="grid grid-cols-2 gap-4 text-white"><div className="bg-blue-600 p-5 rounded-2xl shadow-lg shadow-blue-100"><p className="text-[10px] font-black opacity-70 mb-1">今日紀錄</p><p className="text-3xl font-black italic">{logs.length}</p></div><div className="bg-slate-800 p-5 rounded-2xl shadow-lg shadow-slate-200"><p className="text-[10px] font-black opacity-70 mb-1">K9 成員</p><p className="text-3xl font-black italic">{dogs.length}</p></div></div>
                            </div>
                        )}

                        {tab === 'k9' && (
                            <div className="space-y-4">
                                <div className="flex justify-between items-center"><h2 className="text-2xl font-black text-slate-800">K9 專區</h2><button onClick={()=>setAdd(true)} className="bg-blue-600 text-white p-2 rounded-xl shadow-lg"><Icon name="plus"/></button></div>
                                {add && <form onSubmit={e=>{e.preventDefault(); setDogs([{id:Date.now(), name:e.target.v.value, status:'healthy'}, ...dogs]); setAdd(false)}} className="bg-white p-4 rounded-2xl shadow-md space-y-3"><input name="v" placeholder="名字..." autoFocus /><button className="w-full bg-blue-600 text-white py-3 rounded-xl font-black text-xs">加入</button></form>}
                                {dogs.map(d=><K9Card key={d.id} dog={d} onUpdate={(id, data)=>setDogs(dogs.map(x=>x.id===id?{...x,...data}:x))} onDelete={id=>setDogs(dogs.filter(x=>x.id!==id))} />)}
                            </div>
                        )}

                        {(tab === 'visitors' || tab === 'vehicles' || tab === 'patrol') && (
                            <div className="space-y-4">
                                <div className="flex justify-between items-center"><h2 className="text-2xl font-black text-slate-800">{menu.find(m=>m.id===tab).label}</h2><button onClick={()=>setAdd(true)} className="bg-blue-600 text-white p-2 rounded-xl shadow-lg"><Icon name="plus"/></button></div>
                                {add && <form onSubmit={e=>{e.preventDefault(); setLogs([{id:Date.now(), time:time.toLocaleTimeString([],{hour12:false, hour:'2-digit', minute:'2-digit'}), info:e.target.v.value}, ...logs]); setAdd(false)}} className="bg-white p-4 rounded-2xl shadow-md space-y-3"><input name="v" placeholder="內容..." autoFocus /><button className="w-full bg-blue-600 text-white py-3 rounded-xl font-black text-xs">登記</button></form>}
                                <div className="bg-white rounded-2xl border border-slate-100 overflow-hidden shadow-sm">
                                    {logs.map(l => (
                                        <div key={l.id} className="p-4 border-b border-slate-50 flex items-center justify-between">
                                            <div className="flex items-center gap-4">
                                                <span className="text-xs font-bold text-blue-600 font-mono w-12">{l.time}</span>
                                                {editLog === l.id ? <div className="flex gap-2"><input value={editTxt} onChange={e=>setEditTxt(e.target.value)} className="w-32 py-1"/><button onClick={()=>{setLogs(logs.map(x=>x.id===l.id?{...x, info:editTxt}:x)); setEditLog(null)}} className="text-blue-500"><Icon name="check"/></button></div> : <span className="font-bold text-slate-700 text-sm">{l.info}</span>}
                                            </div>
                                            <div className="flex gap-2 text-slate-300">
                                                <button onClick={()=>{setEditLog(l.id); setEditTxt(l.info)}} className="hover:text-blue-400"><Icon name="pencil" size={14}/></button>
                                                <button onClick={()=>setLogs(logs.filter(x=>x.id!==l.id))} className="hover:text-red-500"><Icon name="trash" size={14}/></button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                    </main>
                </div>
            );
        }
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
