<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç²¾éŠ³å» å€ | ç¸½æ©ŸåŒ…è£¹ç™»è¨˜ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #1e293b; color: white; }
        .log-card { background: #334155; border: 2px solid #475569; box-shadow: 0 8px 0 #0f172a; }
        .btn-courier { background: #475569; transition: all 0.2s; border: 2px solid transparent; }
        .btn-courier.active { background: #f97316; border-color: white; transform: scale(1.05); }
    </style>
</head>
<body class="p-4">
    <header class="text-center mb-6">
        <div class="inline-block p-3 bg-orange-600 rounded-full mb-2">ğŸ“¦</div>
        <h1 class="text-3xl font-black italic">PARCEL SYSTEM</h1>
        <p class="text-xs text-slate-400 tracking-[0.2em]">ç¸½æ©Ÿå°ˆå±¬ç™»è¨˜å¹³å°</p>
    </header>

    <div class="max-w-md mx-auto space-y-6">
        <section class="log-card p-4 rounded-2xl">
            <label class="block text-sm font-bold text-orange-400 mb-3">â— é¸æ“‡ç‰©æµå…¬å¸</label>
            <div class="grid grid-cols-3 gap-2" id="courierGrid">
                <button onclick="selectCourier(this, 'é»‘è²“')" class="btn-courier p-3 rounded-xl font-bold text-sm">é»‘è²“</button>
                <button onclick="selectCourier(this, 'å¤§æ¦®')" class="btn-courier p-3 rounded-xl font-bold text-sm">å¤§æ¦®</button>
                <button onclick="selectCourier(this, 'æ–°ç«¹')" class="btn-courier p-3 rounded-xl font-bold text-sm">æ–°ç«¹</button>
                <button onclick="selectCourier(this, 'éƒµå±€')" class="btn-courier p-3 rounded-xl font-bold text-sm">éƒµå±€</button>
                <button onclick="selectCourier(this, 'å¤–é€')" class="btn-courier p-3 rounded-xl font-bold text-sm">å¤–é€</button>
                <button onclick="selectCourier(this, 'å…¶ä»–')" class="btn-courier p-3 rounded-xl font-bold text-sm">å…¶ä»–</button>
            </div>
        </section>

        <section class="log-card p-4 rounded-2xl">
            <label class="block text-sm font-bold text-orange-400 mb-2">â— æ”¶ä»¶äººå§“å</label>
            <select id="receiver" class="w-full p-4 bg-slate-800 rounded-xl text-xl font-bold border-none outline-none text-white">
                <option value="ä½•é´»æ¦®">ä½•é´»æ¦®</option>
                <option value="è”¡æ˜“å€«">è”¡æ˜“å€«</option>
                <option value="é‚±é´»éˆ">é‚±é´»éˆ</option>
                <option value="æŸ³æ—­å·">æŸ³æ—­å·</option>
                <option value="é­æ¦®å¿—">é­æ¦®å¿—</option>
                <option value="å¾å­å‚‘">å¾å­å‚‘</option>
                <option value="è¾¦å…¬å®¤">è¾¦å…¬å®¤</option>
            </select>
        </section>

        <button onclick="saveParcel()" id="saveBtn" class="w-full py-5 bg-orange-600 rounded-2xl text-2xl font-black shadow-[0_6px_0_#9a3412] active:shadow-none active:translate-y-1">
            ç¢ºèªç™»è¨˜ä¸¦ä¸Šå‚³
        </button>
    </div>

    <script>
        let selectedCourier = "";
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxm4CDB5i8V2CX6lbCu4gxI2TH-jGKFznI8H01CLlnKEh9Fdr71pfeQr7ai6VcVtAvomw/exec";

        function selectCourier(btn, name) {
            document.querySelectorAll('.btn-courier').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            selectedCourier = name;
        }

        async function saveParcel() {
            const receiver = document.getElementById('receiver').value;
            const btn = document.getElementById('saveBtn');

            if(!selectedCourier) { alert("è«‹å…ˆé»é¸ç‰©æµå…¬å¸ï¼"); return; }

            btn.disabled = true;
            btn.innerText = "å‚³è¼¸ä¸­...";

            try {
                // ç™¼é€åˆ°å¦³çš„ Google è½‰é‹ç«™ï¼Œæ¨™è¨˜ç‚ºåŒ…è£¹é¡å‹
                await fetch(`${SCRIPT_URL}?type=parcel&courier=${encodeURIComponent(selectedCourier)}&receiver=${encodeURIComponent(receiver)}`, { mode: 'no-cors' });
                
                alert(`âœ… ç™»è¨˜æˆåŠŸï¼\nç‰©æµï¼š${selectedCourier}\næ”¶ä»¶äººï¼š${receiver}`);
                location.reload(); // ç™»è¨˜å®Œé‡æ•´ï¼Œæ–¹ä¾¿ä¸‹ä¸€ä»¶ç™»è¨˜
            } catch (e) {
                alert("é€£ç·šå¤±æ•—ï¼");
                btn.disabled = false;
                btn.innerText = "é‡æ–°ç™»è¨˜";
            }
        }
    </script>
</body>
</html>
