<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>M-SECURITY | HQ ç¸½éƒ¨çµ‚ç«¯ V5.5</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { background-color: #000; color: #00f2ff; font-family: "Microsoft JhengHei", sans-serif; padding: 20px; }
        .header { border-bottom: 2px solid #00f2ff; padding-bottom: 10px; margin-bottom: 20px; }
        .section { background: #111; padding: 20px; border-radius: 5px; border: 1px solid #333; margin-bottom: 30px; }
        h2 { color: #4da1ff; font-size: 18px; margin-top: 0; border-left: 5px solid #00f2ff; padding-left: 10px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-bottom: 15px; }
        label { font-size: 12px; color: #888; display: block; margin-bottom: 5px; }
        input, select { background: #1a1a1a; border: 1px solid #444; color: #fff; padding: 10px; width: 100%; box-sizing: border-box; }
        .btn { background: #00f2ff; color: #000; border: none; padding: 12px 25px; font-weight: bold; cursor: pointer; border-radius: 3px; }
        .btn-red { background: #ff4d4f; color: #fff; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { text-align: left; color: #4da1ff; border-bottom: 1px solid #333; padding: 10px; font-size: 14px; }
        td { padding: 12px 10px; border-bottom: 1px solid #222; color: #ccc; font-size: 14px; }
        .confirmed { color: #10b981; font-weight: bold; }
    </style>
</head>
<body>

    <div class="header">
        <h1>M-SECURITY è³‡æ–™åº«ç®¡ç†å¾Œå°</h1>
        <div style="color: #888; font-size: 12px;">UNIT: HQ-COMMANDER | STATUS: ONLINE</div>
    </div>

    <div class="section">
        <h2>ğŸ‘¥ å“¡å·¥è³‡æ–™éƒ¨ç½² / ğŸ›‘ ç®¡åˆ¶é»‘åå–®</h2>
        <div class="grid">
            <input type="text" id="eID" placeholder="å·¥è™Ÿ">
            <input type="text" id="eName" placeholder="å§“å">
            <input type="text" id="eDept" placeholder="å–®ä½">
            <input type="text" id="ePlate" placeholder="è»Šç‰Œ">
        </div>
        <button class="btn" onclick="upEmp()">åŒæ­¥å“¡å·¥</button>
        <button class="btn btn-red" onclick="upBlack()">ç™¼å¸ƒé»‘åå–®</button>
        <div id="dataDisp" style="margin-top:20px; max-height: 200px; overflow-y: auto;">
            <table id="eTab"><thead><tr><th>é¡åˆ¥</th><th>å°è±¡</th><th>è©³æƒ…</th><th>æ“ä½œ</th></tr></thead><tbody id="masterList"></tbody></table>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ• K9 è‡¨åºŠç´€éŒ„æ›´æ–°</h2>
        <div class="grid">
            <select id="k9Name">
                <option value="å¸ƒä¸">å¼µå¸ƒä¸</option><option value="å°ç™½">è”¡å°ç™½</option><option value="å°èŠ±">è”¡å°èŠ±</option>
                <option value="ä¾†é †">ä¾†é †</option><option value="ç“œç“œ">å“ˆèœœç“œ</option><option value="è²´è²´">è”¡é ­è²´</option>
                <option value="è”¡å“º">è”¡å“º</option><option value="æœ‰éŒ¢">æœ‰éŒ¢</option>
            </select>
            <input type="text" id="k9Note" placeholder="è¼¸å…¥ç•¶å‰é†«ç™‚æˆ–ç‹€æ³ç´€éŒ„">
        </div>
        <button class="btn" onclick="upK9()">æ›´æ–° K9 ç‹€æ…‹</button>
    </div>

    <div class="section">
        <h2>ğŸ“¡ å‰ç·šå³æ™‚ç‹€æ…‹ç›£æ§ (è¨ªå®¢ & äº¤æ¥)</h2>
        <div class="grid" style="grid-template-columns: 1fr 1fr;">
            <div>
                <h3 style="font-size:14px; color:#4da1ff;">æœ€è¿‘è¨ªå®¢ç™»è¨˜</h3>
                <table id="vTab"><thead><tr><th>å§“å</th><th>æ™‚é–“</th></tr></thead><tbody id="vList"></tbody></table>
            </div>
            <div>
                <h3 style="font-size:14px; color:#4da1ff;">æœ€æ–°å‹¤å‹™äº¤æ¥</h3>
                <table id="dTab"><thead><tr><th>äº‹é …</th><th>ç°½ç½²</th></tr></thead><tbody id="dList"></tbody></table>
            </div>
        </div>
    </div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyB2_tKKsVT4kdW7PPkJgI9O7S1YdCWor48",
        databaseURL: "https://factor-security-d1965-default-rtdb.firebaseio.com",
        projectId: "factor-security-d1965",
        appId: "1:864846943143:web:4cfa18cd20d2f712225c82"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // --- å“¡å·¥èˆ‡é»‘åå–®é‚è¼¯ ---
    function upEmp() {
        const id = document.getElementById('eID').value.trim(), name = document.getElementById('eName').value.trim();
        const dept = document.getElementById('eDept').value.trim(), plate = document.getElementById('ePlate').value.trim().toUpperCase();
        if(!id) return alert("è«‹è¼¸å…¥å·¥è™Ÿ");
        const d = { id, name, dept, plate };
        db.ref('employee_list/' + id).set(d);
        if(plate) db.ref('employee_list/' + plate).set(d);
        alert("å“¡å·¥åŒæ­¥æˆåŠŸ");
    }

    function upBlack() {
        const name = document.getElementById('eName').value.trim();
        const reason = document.getElementById('eDept').value.trim(); // å€Ÿç”¨å–®ä½æ¬„ä½ç•¶åŸå› 
        if(!name) return alert("è«‹åœ¨å§“åæ¬„è¼¸å…¥é»‘åå–®å°è±¡");
        db.ref('blacklist_data').push({ name, reason, time: new Date().toLocaleDateString() });
        alert("é»‘åå–®ç™¼å¸ƒæˆåŠŸ");
    }

    // --- K9 é†«ç™‚é‚è¼¯ ---
    function upK9() {
        const dog = document.getElementById('k9Name').value;
        const note = document.getElementById('k9Note').value;
        if(!note) return alert("å…§å®¹ä¸å¯ç©ºç™½");
        db.ref('k9Logs/' + dog).push({ note, timestamp: Date.now(), time: new Date().toLocaleString() });
        alert(dog + " ç´€éŒ„å·²æ›´æ–°");
        document.getElementById('k9Note').value = '';
    }

    // --- å³æ™‚æ•¸æ“šç›£æ§ ---
    db.ref('employee_list').on('value', s => {
        const l = s.val(), b = document.getElementById('masterList'); b.innerHTML = '';
        for(let k in l) if(k === l[k].id) b.innerHTML += `<tr><td>å“¡å·¥</td><td>${l[k].name}</td><td>${l[k].plate}</td><td><button onclick="db.ref('employee_list/${l[k].id}').remove()">åˆªé™¤</button></td></tr>`;
    });

    db.ref('visitor_logs').limitToLast(5).on('value', s => {
        const l = s.val(), b = document.getElementById('vList'); b.innerHTML = '';
        if(l) Object.values(l).reverse().forEach(v => { b.innerHTML += `<tr><td>${v.name}</td><td>${v.timeIn}</td></tr>`; });
    });

    db.ref('reactLogs').limitToLast(5).on('value', s => {
        const l = s.val(), b = document.getElementById('dList'); b.innerHTML = '';
        if(l) Object.keys(l).reverse().forEach(k => {
            const d = l[k];
            b.innerHTML += `<tr><td>${d.note.substring(0,10)}..</td><td class="${d.confirmedBy?'confirmed':''}">${d.confirmedBy || 'æœªé–±'}</td></tr>`;
        });
    });
</script>
</body>
</html>
